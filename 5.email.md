# Email Assignment 


## Support Materials

* "On-line" man pages: `telnet`,  `mutt`, `mail`

* Simple Mail Transfer Protocol (**SMTP**) - RFC5321

* Multipurpose Internet Mail Extensions (**MIME**):  
  * Part One: Format of Internet Message Bodies (RFC2045)
  * Part Two: Media Types (RFC2046)

* An Extensible Message Format for Delivery Status Notifications – RFC 3464

## Introduction

We will use the local email server that is running in the Telematics laboratory machines: `localhost` and as a client `telnet`. 
An email address is associated to this server: `a0499081@lab.it.uc3m.es`, where `uid` can be obtained using the `id` command in a terminal.

We will start testing the SMTP protocol with different sending options, then we will test message composition using MIME and finally
notifications and security mechanisms. 

## Email sending

#### 1.	Start a session with the email server using `telnet`:
```
~> telnet localhost 25
```

A welcome message should be returned by the email server identified by the code `220`.

#### 2.	Now the server waits for the host identification that has started the connection. Identify as localhost in the `HELO` message.
HELO localhost

#### 3.	Is it possible to change for using ESMTP after the `HELO` message? How would you do?
No, You must close the connection and reconnect, then use EHLO first.

#### 4.	What is the maximum message size that is accepted by the server? How do you obtain this value?
```
Step 1: Use EHLO  
EHLO localhost  
Step 2: Look at the server response
EHLO localhost  
250-monitor01.lab.it.uc3m.es  
250-PIPELINING  
**250-SIZE 10240000**  
250-VRFY  
250-ETRN  
250-STARTTLS  
250-ENHANCEDSTATUSCODES  
250-8BITMIME  
250-DSN  
250 CHUNKING  
```
#### 5.	Send a message to your email address in `localhost` from your same email address `localhost`. What headers are added by the SMTP server?
```
EHLO localhost  
250-monitor01.lab.it.uc3m.es  
250-PIPELINING  
250-SIZE 10240000  
250-VRFY  
250-ETRN  
250-STARTTLS  
250-ENHANCEDSTATUSCODES  
250-8BITMIME  
250-DSN  
250 CHUNKING  
MAIL FROM: a0499081@lab.it.uc3m.es  
250 2.1.0 Ok  
RCPT TO: a0499081@lab.it.uc3m.es  
250 2.1.5 Ok  
DATA  
354 End data with <CR><LF>.<CR><LF>  
Subject: Hola buenas  
  
asdfasfasd  
.  
250 2.0.0 Ok: queued as 04535280336  
QUIT
```

> Note: `mail` can be used to check the received emails.

#### 6.	Send a message to your UC3M email address (`niu@alumnos.uc3m.es`) from your localhost email address (`uid@lab.it.uc3m.es`) and check the headers in the received messsage: 
*  Are they different from those in the previoues point?
```Yes, they are. To google we can see MTUs, Security checks and Passing the mail from one server to another, until it reaches my email.```
*  What servers have processed the message to reach its destination?
```it000; it013; smtp02; mx.google.com and internal google servers```
*  How is the message identified in every server? 
```The first server assigns a global id. Nonetheless, each server assigns a temporaly id.``` 
*  What would it need in order to know what user actually composes the message?
```AS you know that the mail comes from a local host, you would need to gain access to server logs on and see the user who autenticated at the timestamp of sending the email.```

  
#### 7.	Send an email to several recipients. How is the procedure? Is it possible to transmit groups of SMTP commands in batches without waiting for a response to each individual command? Why? 

```
The procedure is the same, but now we hace to put several times in different lines: "RCPT TO: "

Yes it is possible, as we can see doing EHLO, we have the ability of sending emails without needing to exit the server (PIPELINE).
```

#### 8.	Try to add experimental headers in the mail `(X-)`. How are the headers shown in the received mail, for instance, using `mutt`?
```
After sending the message, we check the email by typing "mutt" in the console. Then we select out of all of the emails the one we are interested in. Then press "h" and we see all the headers. This is what we see:
```
In the sender side:
```
a0486151@it014:/var/home/lab/alum0/04/86/151$ telnet localhost 25
Trying 127.0.0.1...
Connected to localhost.
Escape character is '^]'.
220 it014.lab.it.uc3m.es ESMTP Postfix
EHLO localhost
250-it014.lab.it.uc3m.es
250-PIPELINING
250-SIZE 10240000
250-VRFY
250-ETRN
250-STARTTLS
250-ENHANCEDSTATUSCODES
250-8BITMIME
250-DSN
250 CHUNKING
MAIL FROM: a0486151@lab.it.uc3m.es
250 2.1.0 Ok
RCPT TO: a0486151@lab.it.uc3m.es
250 2.1.5 Ok
DATA
354 End data with <CR><LF>.<CR><LF>
X-MisCojones: viniciusjunior
This is the bodymilk.
.
250 2.0.0 Ok: queued as 230421689
QUIT 
221 2.0.0 Bye
Connection closed by foreign host.

```

In the receiver side:
```
From a0486151@lab.it.uc3m.es  Thu Nov 20 17:13:59 2025
Return-Path: <a0486151@lab.it.uc3m.es>
X-Original-To: a0486151@lab.it.uc3m.es
Delivered-To: a0486151@lab.it.uc3m.es
Received: from lm000.lab.it.uc3m.es (lm000.lab.it.uc3m.es [IPv6:2001:720:410:100c::129])
        by lab.it.uc3m.es (Postfix) with ESMTP id DEBA128173A
        for <a0486151@lab.it.uc3m.es>; Thu, 20 Nov 2025 17:13:59 +0100 (CET)
Received: from it014.lab.it.uc3m.es (it014.lab.it.uc3m.es [163.117.144.214])
        by lm000.lab.it.uc3m.es (Postfix) with ESMTP id CF8994A008E
        for <a0486151@lab.it.uc3m.es>; Thu, 20 Nov 2025 17:13:59 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=lab.it.uc3m.es;
        s=mail; t=1763655239;
        bh=3gZsqDdtCDuJQUMAxby7kbxxbucjidUybsWgrBlFRCU=; h=Date:From:From;
        b=fPU/mmPM9s79a24lGdU3Piqc2/bmRwCbTtj2rckCe5ptr7u/unKwWJmTe/HHrA0kX
        eapOJhUT0PRwh7H6pUZ+VUH2eXyC1xwlmSEG6ov8nRi1co4BJTV4VFMr6LeoX9sX3p
        48JGQ27mseu6ZZu3Q2y6Vd8yJg1OSBz5TbIHK3xo=
Received: from localhost (localhost [127.0.0.1])
        by it014.lab.it.uc3m.es (Postfix) with ESMTP id 230421689
        for <a0486151@lab.it.uc3m.es>; Thu, 20 Nov 2025 17:12:15 +0100 (CET)
X-MisCojones: viniciusjunior
Message-Id: <20251120161233.230421689@it014.lab.it.uc3m.es>
Date: Thu, 20 Nov 2025 17:12:15 +0100 (CET)
From: a0486151@lab.it.uc3m.es

This is the bodymilk.
```


## Multipurpose Internet Mail Extension (MIME)

#### 9.	Send an mail to your address in `localhost` from your same email address using MIME.

```
To do this we just need to add several headers... (Headers are added inside the DATA).
```
Sender side:
```
a0486151@it014:/var/home/lab/alum0/04/86/151$ telnet localhost 25
Trying 127.0.0.1...
Connected to localhost.
Escape character is '^]'.
220 it014.lab.it.uc3m.es ESMTP Postfix
EHLO localhost
250-it014.lab.it.uc3m.es
250-PIPELINING
250-SIZE 10240000
250-VRFY
250-ETRN
250-STARTTLS
250-ENHANCEDSTATUSCODES
250-8BITMIME
250-DSN
250 CHUNKING
MAIL FROM: a0486151@lab.it.uc3m.es
250 2.1.0 Ok
RCPT TO: a0486151@lab.it.uc3m.es
250 2.1.5 Ok
DATA
354 End data with <CR><LF>.<CR><LF>
MIME-Version: 1.0
Content-Type: text/plain: charset=us-ascii
Content-Transfer-Encoding: 7bit
Mensaje de MIME a ver qué pasa.
.
250 2.0.0 Ok: queued as D028A1689
QUIT
221 2.0.0 Bye
Connection closed by foreign host.
```
Receiver side:
```
From a0486151@lab.it.uc3m.es  Thu Nov 20 17:28:15 2025
Return-Path: <a0486151@lab.it.uc3m.es>
X-Original-To: a0486151@lab.it.uc3m.es
Delivered-To: a0486151@lab.it.uc3m.es
Received: from lm000.lab.it.uc3m.es (repldap02.lab.it.uc3m.es [163.117.144.9])
        by lab.it.uc3m.es (Postfix) with ESMTP id C8BA5281609
        for <a0486151@lab.it.uc3m.es>; Thu, 20 Nov 2025 17:28:15 +0100 (CET)
Received: from it014.lab.it.uc3m.es (it014.lab.it.uc3m.es [163.117.144.214])
        by lm000.lab.it.uc3m.es (Postfix) with ESMTP id AC7B14A008E
        for <a0486151@lab.it.uc3m.es>; Thu, 20 Nov 2025 17:28:15 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=lab.it.uc3m.es;
        s=mail; t=1763656095;
        bh=p9szrE0j76XmMftWhBWToam+n6dcWFasuQWr8XhTsQ0=; h=Date:From:From;
        b=BqEu7Q17lAROUZpSXBqlpMFqWsiabTZTRRYeaYIl9xM0BY8QtmpT3UksMz4tqQgtN
        ZP5o+bOKeS1crK1hEhpzoQdWvKVhrn0rVBj9UIl8lxkJQd//+bbGMU93wvxpYuwbUm
        61a5SGgZOc//aJNgszzyvEktUieQ4lOIJ/f3E34U=
Received: from localhost (localhost [127.0.0.1])
        by it014.lab.it.uc3m.es (Postfix) with ESMTP id D028A1689
        for <a0486151@lab.it.uc3m.es>; Thu, 20 Nov 2025 17:26:54 +0100 (CET)
MIME-Version: 1.0
Content-Type: text/plain: charset=us-ascii
Content-Transfer-Encoding: 7bit
Message-Id: <20251120162708.D028A1689@it014.lab.it.uc3m.es>
Date: Thu, 20 Nov 2025 17:26:54 +0100 (CET)
From: a0486151@lab.it.uc3m.es

Mensaje de MIME a ver qu?? pasa.
```

#### 10. Compose a multi-part message of type "mixed" with at least two parts: for example, one with plain text content and another with a file (e.g., .png, .dot, ...). What headers need to be added? Is there anything else that needs to be added to separate the parts? 

> Note: To define content in plain text with an ISO-8859-1 encoding, you can use `Content-type: text/plain; charset="ISO-8859-1"`, or for an image, you can use the following headers:

```
Content-type: image/png; filename="imagen.png"
Content-Disposition: attachment; filename="imagen.png"
Content-Transfer-Encoding: base64
```


```
a0486151@it014:/var/home/lab/alum0/04/86/151$ telnet localhost 25
Trying 127.0.0.1...
Connected to localhost.
Escape character is '^]'.
220 it014.lab.it.uc3m.es ESMTP Postfix
EHLO localhost
250-it014.lab.it.uc3m.es
250-PIPELINING
250-SIZE 10240000
250-VRFY
250-ETRN
250-STARTTLS
250-ENHANCEDSTATUSCODES
250-8BITMIME
250-DSN
250 CHUNKING
MAIL FROM: a0486151@lab.it.uc3m.es
250 2.1.0 Ok
RCPT TO: a0486151@lab.it.uc3m.es
r250 2.1.5 Ok
RCPT TO: 100486151@alumnos.uc3m.es
250 2.1.5 Ok
DATA
354 End data with <CR><LF>.<CR><LF>
Subject: Two parts: Text and Image
MIME-Version: 1.0
Content-Type: multipart/mixed; boundary="myboundary123"

This is the preamble. It is ignored by email clients.
--myboundary123
Content-Type: text/plain; charset="ISO-8859-1"

Hello! This is the first part of the message.
It is just plain text.
--myboundary123
Content-type: image/png; filename="dot.png"
Content-Disposition: attachment; filename="dot.png"
Content-Transfer-Encoding: base64

iVBORw0KGgoAAAANSUhEUgAAAEMAAAAjCAMAAAD44EcbAAAAPFBMVEUQCg4REBgkEBA1EA0aFyIwHyPTopfdtq70OjHyUEXwIx/eCwtPPkCxe3BCLjGgTkODY1/GkITnbmORHhcpaz64AAADS0lEQVR4nGWWiZKsIAxF2QWb3f//17kJoOikXvV00eZws/qEJlNKCaHGFzI+tIYMPwgpJX0K/GKmjaNp9LDVxCCIGl+GjYcFu7PhDL7P8cMwxBDLlW+VWgFnLN23PUs/L4Z8MfT0vQ1PsQwLw4XSWPKQxBiBfYUwQ6wQJoIhYOQIKbbCIo7XFf+UaIpDLdsZQNQY4Z8crEa76fwwKEZDuqkeRDE3I8ZUaynJHWTxScsnGM6TZVNcGHEjrE0p1dTaYOTH46MDudgZmlTJxThSq0DUWN2tg2/ahUjOppwIZlBpJch01GDOtVRsbWnqoIA/wYx6DRV8BTMkMzIioDhaqS5lsxj00BaMFJa/w1/rGcuUB0Y9Zi7os1o16kc6uDR3LGgjMydkfs68UUrhPBiApMz+o592hhCZwtD6YejRbpii7EgANUejAmmt1ny+YhEiAqIfxhg/lpzb4dqwUlPK+n5s9urDeCArlqHZVsTBZWmAxagWYja8fMafy7oY6pl9GykXKGtKLVGro5c3yD+G3hijfnZOSUvXBQow2fBAcBPIBbkbZGess3z0Dh2ulwsQUCItE5vJeCEI+dpka/9tS0SVfv58dy6VcmmdsQOwB2qqOcY4GIAIeS+5fe5Xos/z/P3OToiraB4QSvHRKjGm7xQiV7e/LPrgf2SxxOvSg5F4eCvK+F6mNBfGfhnx7OEkxAWXWLgxTHTcsumLGPOC+N6I7kPw5+88PVKCgWMdKDVPzWcdMwP5ynY/NbUH37tHShCSLyEQIyf0GtZRNV8ZYCDRMZstq7FBBDDMwB9maGo1EL5vi6mcIejL1V6lsf85GB3/kJArUJPU+J61jYG2oVEfQjTcPIIIR8cfELpL2lOpe7Tz1bJDqMI8c2N7MiR7XA1v1CCwEsDKj8p06fla2FqUX1g8L9hCaxRMDZRJj3Y63Hkiu6E3bpbrUsywZkfwLqLOlWoyrJIVANx/uHocHtVFiTr3G8l4dLCW+cYTCFLIhYCQ4tmzYYVRbsFAz3Ioal28APJm0L6e+SDGxZ4hOIqJW+ScMtaQmEVYqpBTK7k5+IUABodCATEjhIm47GLMKO6IeBeO/3WMlgODO8N7Tq1fKiBDigfyGI7+ADVFKZxXLnnPAAAAAElFTkSuQmCC

--myboundary123--
.
250 2.0.0 Ok: queued as E001A16B7
QUIT
221 2.0.0 Bye
Connection closed by foreign host.

```

#### 11. Use a content transport encoding for the `Subject`. Try using both `"Quoted Printable"` and `"Base 64"`.

```
EHLO localhost
MAIL FROM: a0486151@lab.it.uc3m.es
RCPT TO: a0486151@lab.it.uc3m.es
DATA
From: Me <a0486151@lab.it.uc3m.es>
To: Me <a0486151@lab.it.uc3m.es>
Subject: =?ISO-8859-1?Q?Cami=F3n?=

This message uses Quoted Printable in the subject line.
.
```

Base 64:
```
MAIL FROM: a0486151@lab.it.uc3m.es
RCPT TO: a0486151@lab.it.uc3m.es
DATA
From: Me <a0486151@lab.it.uc3m.es>
To: Me <a0486151@lab.it.uc3m.es>
Subject: =?ISO-8859-1?B?SG9sYQ==?=

This message uses Base64 in the subject line.
.
```



## Notification and Security

#### 12.	 Send an email indicating that you want to receive a Delivery Status Notification (DSN) message from the sender, which should be provided by the SMTP server of the recipient email address.

> Note: refer to  [RFC 3464](https://datatracker.ietf.org/doc/html/rfc3464) and [RFC3461](https://datatracker.ietf.org/doc/html/rfc3461) for more information. 

```markdown
EHLO localhost
250-it014.lab.it.uc3m.es
250-PIPELINING
250-SIZE 10240000
250-VRFY
250-ETRN
250-STARTTLS
250-ENHANCEDSTATUSCODES
250-8BITMIME
250-DSN
250 CHUNKING
MAIL FROM: <a0486151@lab.it.uc3m.es>
250 2.1.0 Ok
RCPT TO: <a0486151@lab.it.uc3m.es> **NOTIFY=SUCCESS**
250 2.1.5 Ok
DATA
Subject: Testing DSN
From: Me <a0486151@lab.it.uc3m.es>
To: Me <a0486151@lab.it.uc3m.es>

This email should trigger a delivery receipt.
.
QUIT354 End data with <CR><LF>.<CR><LF>

```

####  13.	Send an email using STARTTLS and capture the traffic using `tcpdump` (or `Wireshark`). Compare both traffic captures (with and without STARTTLS). What is the difference between them? 

There are functionalities to secure the email exchange using TLS (*Transport Layer Security*); so a protected session can be established. You can try this option using:
```
~> openssl s_client –starttls smtp -crlf -connect localhost:25
```
```
a0486151@it014:/var/home/lab/alum0/04/86/151$ openssl s_client -starttls smtp -crlf -connect localhost:25
CONNECTED(00000003)
Can't use SSL_get_servername
depth=0 CN = it002
verify return:1
---
Certificate chain
 0 s:CN = it002
   i:CN = it002
   a:PKEY: rsaEncryption, 2048 (bit); sigalg: RSA-SHA256
   v:NotBefore: Jun 10 16:52:04 2022 GMT; NotAfter: Jun  7 16:52:04 2032 GMT
---
Server certificate
-----BEGIN CERTIFICATE-----
MIICzTCCAbWgAwIBAgIUV037yEEprwTzTm7g1lotbG+c5nEwDQYJKoZIhvcNAQEL
BQAwEDEOMAwGA1UEAwwFaXQwMDIwHhcNMjIwNjEwMTY1MjA0WhcNMzIwNjA3MTY1
MjA0WjAQMQ4wDAYDVQQDDAVpdDAwMjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCC
AQoCggEBAL+z/ZLtxJA4TX/lFO5DQwAZpfWeSWcIUF2EDpwS5A0fiZWbydeqCqGB
p+jRh7KF0ATrXgI5oTuplYSpv4zCqJFptLbTB2dtCjoHZlijNP+BRd5m3Kb+1IIS
YXxJBMuFhUx+PNQTvXbra7HtB9+MjBWuGs4UUcCAiXRYdzXtioOHZ5rI2pfNxkNq
VhPTdwrE/kPR7nECJArRNyq7I2/WvqzFi6ECnA7p5u32ddZMy09Dnh0PwgdG6iHM
tZrzxlAGH/FhwXTYwGspKqYfNPffKktHyhr4z1UrfALhnBDENEmgCgqb9JnykyUs
g07BJVXKWpdJb/DZVzQgGmC3CnZkHXkCAwEAAaMfMB0wCQYDVR0TBAIwADAQBgNV
HREECTAHggVpdDAwMjANBgkqhkiG9w0BAQsFAAOCAQEAIg+vOChLS6DUPCdeg7y0
b92DpF+JV1EOFH3Rytg3ueMX/nI5BJmCuUiwYTkVMET5Nsy3GfXX6Stqwsa8d+9+
oj5OYtGBLQHRO335emub0czL43SZHOElVaO0lS3/SwQpsls1AXKSAMLqF56Q7S+o
CdbhriKMereBMOlFP6xPqLuKrob/bdgnYtxd/Li8vkZth38EUOxV5uWBPomwO5//
z3F94ePeo+5B5U0H2mus4TokiQG+kHZhsVgcj8moeUjc4504io/J25bNoYb1EJWN
m3S6W5IaYT3u4+HEEwYGnAMNr3FsMDjfgiQOCp6PqYwYMl3GXYjdy3fRC2Y8DEFE
Sw==
-----END CERTIFICATE-----
subject=CN = it002
issuer=CN = it002
---
No client certificate CA names sent
Peer signing digest: SHA256
Peer signature type: RSA-PSS
Server Temp Key: X25519, 253 bits
---
SSL handshake has read 1504 bytes and written 410 bytes
Verification: OK
---
New, TLSv1.3, Cipher is TLS_AES_256_GCM_SHA384
Server public key is 2048 bit
Secure Renegotiation IS NOT supported
Compression: NONE
Expansion: NONE
No ALPN negotiated
Early data was not sent
Verify return code: 0 (ok)
---
250 CHUNKING
---
Post-Handshake New Session Ticket arrived:
SSL-Session:
    Protocol  : TLSv1.3
    Cipher    : TLS_AES_256_GCM_SHA384
    Session-ID: 3D49DCDAF4893C116492B3D56EF02F21934316B6BDBC9A261044578974EBE326
    Session-ID-ctx: 
    Resumption PSK: 931C4D73F3233B4CC4C7AF8BB03693C2ACEEB3800074D7931032466E229ABAE994219E0C73E043A2B435505544A80CFB
    PSK identity: None
    PSK identity hint: None
    SRP username: None
    TLS session ticket lifetime hint: 7200 (seconds)
    TLS session ticket:
    0000 - c8 e2 57 65 d8 27 77 cc-50 11 d4 17 cc 89 a0 30   ..We.'w.P......0
    0010 - 1a 3d 07 74 a9 d2 c9 e6-14 80 d3 32 1e 9b 42 a9   .=.t.......2..B.
    0020 - ca 1f f8 fe a7 f9 fa 84-bf 45 1e 4c 2a a5 c6 d9   .........E.L*...
    0030 - 3a 28 42 e4 63 ed 64 db-17 0d af fb 55 1b 5a 01   :(B.c.d.....U.Z.
    0040 - 85 6f ac a6 73 4c c7 a6-c4 5c 9f 20 3e 57 1b 4b   .o..sL...\. >W.K
    0050 - f3 c4 d4 4c 0f c9 e7 7a-04 62 34 44 af c2 0f fc   ...L...z.b4D....
    0060 - 4d 57 37 46 d0 7f f8 de-ce 7d 22 f3 be 06 c2 40   MW7F.....}"....@
    0070 - 7b 68 78 1b e8 db 96 08-cd f9 e5 c6 ac 4e 94 cb   {hx..........N..
    0080 - 5c 9f 1e ca c0 98 ef 19-f8 89 09 b6 c3 89 bd 70   \..............p
    0090 - e3 38 af 10 e3 86 75 4f-09 a2 e5 bd 9d d1 2f 83   .8....uO....../.
    00a0 - c3 e4 4f 05 76 90 68 5f-0d 3a e5 81 2c 41 e2 dd   ..O.v.h_.:..,A..
    00b0 - 6b 63 53 48 47 c2 ed 39-b6 6d 89 60 2a eb bb 4c   kcSHG..9.m.`*..L
    00c0 - 11 c6 84 c3 6f b0 3b e3-46 f9 4f 3f 43 90 73 b4   ....o.;.F.O?C.s.

    Start Time: 1763659901
    Timeout   : 7200 (sec)
    Verify return code: 0 (ok)
    Extended master secret: no
    Max Early Data: 0
---
read R BLOCK
EHLO localhost
250-it014.lab.it.uc3m.es
250-PIPELINING
250-SIZE 10240000
250-VRFY
250-ETRN
250-ENHANCEDSTATUSCODES
250-8BITMIME
250-DSN
250 CHUNKING
mail from: <a0486151@lab.it.uc3m.es>
250 2.1.0 Ok
rcpt to: <a0486151@lab.it.uc3m.es>
250 2.1.5 Ok
data
354 End data with <CR><LF>.<CR><LF>
Subject: Secure email attempt tu puta madre

Esto va a funcionar porque lo digo yo y gusi
.
250 2.0.0 Ok: queued as D77F816C0
QUIT
DONE

```
#### 14.	The `AUTH` command is used to authenticate the client by sending the user name and password. Does local email server support this option? What advantages offer the use of this command?

No, when running EHLO localhost there is no AUTH tag neither for telnet or openssl

What are the advantages of AUTH?

If the AUTH command is used, the client must provide a username and password (often encoded in Base64) before sending mail.

    Prevention of Open Relays (Spam Control): Without authentication, an SMTP server usually only allows you to send mail to local users (like uid@lab.it.uc3m.es). If you try to send an email to gmail.com, the server will reject it ("Relay access denied").

        With AUTH: The server trusts you. It allows you to "relay" emails to external domains (Gmail, Outlook, etc.) because it knows who you are.

    Identity Verification (Non-Repudiation): It proves that the sender is actually who they claim to be. It prevents a malicious user from easily spoofing your address (MAIL FROM: your_uid@...) because they wouldn't know your password.

    Accountability: The server logs exactly which user sent a specific email, which is crucial for tracking abuse or issues.